<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>üîê Secret Cipher ‚Äî Vowel Numbers</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <style>
    :root {
      --bg: #0d1117;
      --card: #161b22;
      --text: #e6edf3;
      --accent: #7b61ff;
      --accent2: #00c6ff;
      --danger: #e55353;
      --success: #4caf50;
    }

    body {
      margin: 0;
      font-family: 'Inter', 'Segoe UI', Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    header {
      text-align: center;
      padding: 20px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      color: #fff;
      border-radius: 0 0 20px 20px;
    }

    main {
      flex: 1;
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      padding: 20px;
      justify-content: center;
    }

    section, aside {
      background: var(--card);
      padding: 20px;
      border-radius: 14px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.5);
      flex: 1;
      min-width: 300px;
    }

    textarea, input {
      width: 100%;
      padding: 12px;
      margin: 10px 0;
      border-radius: 8px;
      border: none;
      background: rgba(255,255,255,0.05);
      color: var(--text);
      font-size: 15px;
    }

    button {
      padding: 10px 14px;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      background: var(--accent);
      color: #fff;
      transition: 0.2s ease;
    }
    button:hover { opacity: 0.9; }
    button.secondary { background: var(--accent2); }
    button.success { background: var(--success); }
    button.danger { background: var(--danger); }

    .controls { display: flex; gap: 10px; flex-wrap: wrap; }

    .history-item {
      background: rgba(255,255,255,0.05);
      padding: 10px;
      border-radius: 6px;
      margin-bottom: 6px;
      font-size: 14px;
    }

    footer {
      text-align: center;
      padding: 12px;
      background: var(--card);
      font-size: 13px;
      color: #aaa;
    }

    /* login screen */
    #loginScreen {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 99;
    }
    #loginBox {
      background: var(--card);
      padding: 20px;
      border-radius: 12px;
      width: 300px;
      text-align: center;
    }

    #toast {
      position: fixed;
      bottom: 26px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.8);
      padding: 10px 16px;
      border-radius: 22px;
      opacity: 0;
      transition: .25s;
    }
    #toast.show { opacity: 1; transform: translateX(-50%) translateY(-6px); }
  </style>
</head>
<body>
  <!-- Login -->
  <div id="loginScreen">
    <div id="loginBox">
      <h2>üîë Login / Sign Up</h2>
      <select id="userSelect" style="width:100%;margin:6px 0;display:none"></select>
      <input id="username" placeholder="Username">
      <input id="password" type="password" placeholder="Password">
      <button onclick="login()">Login</button>
      <button onclick="signup()" class="secondary">Sign Up</button>
    </div>
  </div>

  <header>
    <h1>üîê Secret Cipher ‚Äî Vowel Numbers</h1>
    <p id="welcomeUser"></p>
    <div style="display:flex;gap:8px;justify-content:center;margin-top:8px">
      <button onclick="openProfile()" class="secondary">Profile</button>
      <button onclick="switchAccount()" class="secondary">Switch Account</button>
      <button onclick="logout()" class="danger">Logout</button>
    </div>
  </header>

  <main>
    <section>
      <h3>üìù Cipher Tool</h3>
      <textarea id="input" placeholder="Type message..."></textarea>
      <textarea id="output" readonly placeholder="Result..."></textarea>
      <div class="controls">
        <button onclick="encode()">Encode</button>
        <button onclick="decode()">Decode</button>
        <button onclick="smartDetect()">Smart Detect</button>
        <button onclick="copyResult()" class="secondary">Copy</button>
        <button onclick="clearAll()" class="danger">Clear</button>
      </div>

      <!-- Quiz -->
      <div style="margin-top:16px;background:rgba(255,255,255,0.03);padding:12px;border-radius:10px">
        <h3>üß© Quiz</h3>
        <div id="quiz-status">Not started</div>
        <div id="quiz-container"></div>
        <button onclick="startQuiz()">Start Quiz</button>
      </div>
      <h4 style="margin-top:12px">üèÜ Leaderboard</h4>
      <div id="leaderboard"></div>
    </section>

    <aside>
      <h3>üìú History</h3>
      <div id="history"></div>
      <button onclick="clearHistory()" class="danger">Clear History</button>
    </aside>
  </main>

  <footer>¬© <span id="year"></span> Secret Cipher</footer>
  <div id="toast"></div>

<script>
  let accounts = JSON.parse(localStorage.getItem("accounts")||"{}");
  let currentUser = null;

  function getUser(){ return accounts[currentUser]; }
  function save(){ localStorage.setItem("accounts",JSON.stringify(accounts)); }

  function toast(m){const t=document.getElementById("toast");t.textContent=m;t.classList.add("show");setTimeout(()=>t.classList.remove("show"),2000);}

  function login(){
    const u=document.getElementById("username").value.trim();
    const p=document.getElementById("password").value.trim();
    if(!u||!p) return toast("‚ö†Ô∏è Fill fields");
    if(!accounts[u]) return toast("‚ùå No such user");
    if(accounts[u].password!==p) return toast("‚ùå Wrong password");
    currentUser=u;localStorage.setItem("currentUser",u);
    document.getElementById("loginScreen").style.display="none";
    document.getElementById("welcomeUser").textContent="Welcome "+u+(accounts[u].nickname?(" ("+accounts[u].nickname+")"):"");
    renderHistory();renderLeaderboard();
    toast("‚úÖ Logged in");
  }

  function signup(){
    const u=document.getElementById("username").value.trim();
    const p=document.getElementById("password").value.trim();
    if(!u||!p) return toast("‚ö†Ô∏è Fill fields");
    if(accounts[u]) return toast("‚ö†Ô∏è User exists");
    accounts[u]={password:p,nickname:"",history:[],scores:[]};
    save();
    currentUser=u;localStorage.setItem("currentUser",u);
    document.getElementById("loginScreen").style.display="none";
    document.getElementById("welcomeUser").textContent="Welcome "+u;
    renderHistory();renderLeaderboard();
    toast("‚úÖ Account created");
    document.getElementById("username").value="";
    document.getElementById("password").value="";
  }

  function logout(){currentUser=null;localStorage.removeItem("currentUser");document.getElementById("loginScreen").style.display="flex";}

  function switchAccount(){
    currentUser=null;localStorage.removeItem("currentUser");
    document.getElementById("loginScreen").style.display="flex";
    let usernames=Object.keys(accounts);
    let dropdown=document.getElementById("userSelect");
    if(usernames.length){
      dropdown.style.display="block";
      dropdown.innerHTML="<option value=''>-- Select User --</option>"+usernames.map(u=>`<option value=\"${u}\">${u}</option>`).join("");
      dropdown.onchange=function(){document.getElementById("username").value=this.value;};
    }
  }

  // profile modal functions (simple inline modal)
  function openProfile(){
    if(!currentUser) return toast("Log in first");
    const nick = getUser().nickname||"";
    const newNick = prompt("Set nickname", nick);
    if(newNick!==null){ getUser().nickname=newNick; save(); document.getElementById("welcomeUser").textContent="Welcome "+currentUser+(newNick?(" ("+newNick+")"):""); toast("Nickname saved"); }
  }

  const vmap={a:"1",e:"2",i:"3",o:"4",u:"5"};
  const vrev={"1":"a","2":"e","3":"i","4":"o","5":"u"};
  function encode(){const txt=document.getElementById("input").value;let out="";for(const c of txt){if(vmap[c])out+=vmap[c];else if(vmap[c.toLowerCase()])out+=vmap[c.toLowerCase()];else if(/[A-Za-z]/.test(c))out+=c+"a";else out+=c;}document.getElementById("output").value=out;addHist("Encoded",txt,out);}
  function decode(){const txt=document.getElementById("input").value;let out="";for(let i=0;i<txt.length;i++){const c=txt[i];if(vrev[c])out+=vrev[c];else if(/[A-Za-z]/.test(c)&&txt[i+1]==="a"){out+=c;i++;}else out+=c;}document.getElementById("output").value=out;addHist("Decoded",txt,out);}
  function smartDetect(){const txt=document.getElementById("input").value;if(/[1-5]/.test(txt))decode();else encode();}
  function copyResult(){navigator.clipboard.writeText(document.getElementById("output").value);toast("Copied")}
  function clearAll(){document.getElementById("input").value="";document.getElementById("output").value="";}

  function addHist(type,inp,res){if(!currentUser)return;let u=getUser();u.history.unshift({type,inp,res,date:new Date().toLocaleString()});u.history=u.history.slice(0,20);save();renderHistory();}
  function renderHistory(){if(!currentUser)return;let h=getUser().history||[];document.getElementById("history").innerHTML=h.length?h.map(x=>`<div class='history-item'><b>${x.type}</b>: ${x.res} <br><small>${x.date}</small></div>`).join(""):"No history";}
  function clearHistory(){if(!currentUser)return;getUser().history=[];save();renderHistory();}

  const qs=["The quick brown fox jumps over the lazy dog.","Knowledge is power, but wisdom is everything.","Dream big and dare to fail.","Great things never come from comfort zones.","Hard work beats talent when talent doesn‚Äôt work hard."];
  let qi=0,score=0,timer=null,pool=[];
  function startQuiz(){if(!currentUser){toast("Log in to play quiz");return;}qi=0;score=0;pool=[...qs].sort(()=>Math.random()-0.5).slice(0,3);showQ();}
  function showQ(){if(qi>=pool.length)return endQ();let s=pool[qi];let enc=encSen(s);document.getElementById("quiz-container").innerHTML=`<div><b>Q${qi+1}</b>: ${enc}</div><input id='ans'><button onclick="subAns('${s.replace(/'/g,\"\\\\'\")}')">Submit</button><div>‚è±<span id='tim'>60</span></div><button onclick="skipQ()">Next</button>`;startT();document.getElementById("quiz-status").textContent=`Question ${qi+1} of ${pool.length}`;}
  function startT(){let t=60;document.getElementById("tim").textContent=t;clearInterval(timer);timer=setInterval(()=>{t--;document.getElementById("tim").textContent=t;if(t<=0){clearInterval(timer);subAns(null,true)}},1000);}
  function subAns(correct,timeout=false){clearInterval(timer);let a=document.getElementById("ans").value; if(!timeout&&a.toLowerCase()===correct.toLowerCase()){score++;toast("‚úÖ Correct")}else if(!timeout){toast("‚ùå Wrong");}qi++;setTimeout(showQ,500);}
  function skipQ(){clearInterval(timer);qi++;showQ();}
  function endQ(){getUser().scores.push(score);save();renderLeaderboard();document.getElementById("quiz-container").innerHTML=`Done! Score: ${score}/${pool.length}`;document.getElementById("quiz-status").textContent='Completed';}
  function encSen(txt){let out="";for(const c of txt){if(vmap[c])out+=vmap[c];else if(vmap[c.toLowerCase()])out+=vmap[c.toLowerCase()];else if(/[A-Za-z]/.test(c))out+=c+"a";else out+=c;}return out;}

  function renderLeaderboard(){if(!currentUser)return;let s=getUser().scores||[];s.sort((a,b)=>b-a);document.getElementById("leaderboard").innerHTML=s.length?s.slice(0,5).map((x,i)=>`#${i+1} ‚Üí ${x}`).join("<br>"):"No scores";}

  document.getElementById("year").textContent=new Date().getFullYear();
  let saved=localStorage.getItem("currentUser");if(saved&&accounts[saved]){currentUser=saved;document.getElementById("loginScreen").style.display="none";document.getElementById("welcomeUser").textContent="Welcome "+saved;renderHistory();renderLeaderboard();}
</script>
</body>
</html>