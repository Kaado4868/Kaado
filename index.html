<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Secret Cipher â€” Modern</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0b5ed7">
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
:root {
  --card: rgba(255,255,255,0.06);
  --glass: rgba(255,255,255,0.15);
  --accent1: linear-gradient(90deg,#7b61ff,#00d2ff);
  --accent2: linear-gradient(90deg,#ff5f8b,#7b61ff);
  --danger: #ef4444;
  --success: #22c55e;
  --muted: rgba(255,255,255,0.65);
  --radius: 14px;
}
*{box-sizing:border-box}
body {
  margin:0;
  font-family:Poppins,Arial;
  background:radial-gradient(800px 400px at 10% 10%, rgba(123,97,255,0.08), transparent),
             linear-gradient(180deg,#071026,#0b1020);
  color:#eaf3ff;
}
header {
  display:flex;align-items:center;justify-content:space-between;
  padding:14px 18px;background:rgba(255,255,255,0.03);backdrop-filter:blur(6px);
}
nav button {
  background:transparent;border:0;color:#fff;margin-left:12px;font-weight:600;
  cursor:pointer;font-size:15px;transition:.3s;
}
nav button.active {color:#00d2ff;text-shadow:0 0 10px #00d2ff;}
nav button:hover {color:#7b61ff;transform:scale(1.1);}

.card {
  background:var(--card);border-radius:var(--radius);padding:20px;
  margin:20px auto;max-width:800px;
  box-shadow:0 6px 20px rgba(0,0,0,0.6);
}
textarea,input {
  width:100%;padding:14px;margin-top:8px;
  border-radius:10px;border:1px solid rgba(255,255,255,0.1);
  background:rgba(255,255,255,0.05);color:inherit;
  font-size:16px;resize:vertical;
}
textarea:focus,input:focus {
  outline:none;
  border-color:#00d2ff;
  box-shadow:0 0 8px rgba(0,210,255,0.5);
}
.controls {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;   /* centers all buttons */
  align-items: center;
  gap: 16px;
  margin-top: 24px;
  width: 100%;
}

.controls .btn {
  flex: 1 1 160px; /* buttons stay equal and wrap on small screens */
  max-width: 200px;
  text-align: center;
}

/* ğŸ¯ BUTTONS â€” Bigger, Rounded, Glow Effects */
.btn {
  position:relative;
  padding:14px 24px;
  border-radius:14px;
  cursor:pointer;
  font-weight:700;
  font-size:16px;
  letter-spacing:0.5px;
  border:0;
  background:var(--accent2);
  color:#fff;
  transition:all .3s ease;
  box-shadow:0 0 12px rgba(255,255,255,0.15), inset 0 0 10px rgba(255,255,255,0.1);
}
.btn:hover {
  transform:translateY(-3px) scale(1.05);
  box-shadow:0 0 18px rgba(123,97,255,0.6),0 0 8px rgba(255,95,139,0.6);
}
.btn:active {
  transform:scale(0.97);
}

.btn.ghost {
  background:transparent;
  border:2px solid rgba(255,255,255,0.2);
  box-shadow:none;
}
.btn.ghost:hover {
  background:rgba(255,255,255,0.1);
  border-color:#00d2ff;
  box-shadow:0 0 12px rgba(0,210,255,0.4);
}

.btn.danger {
  background:var(--danger);
  box-shadow:0 0 12px rgba(239,68,68,0.4);
}
.btn.danger:hover {
  box-shadow:0 0 16px rgba(239,68,68,0.8);
}

/* ğŸ”” Toast */
#toast {
  position:fixed;bottom:20px;left:50%;
  transform:translateX(-50%);
  background:#0b1020;padding:12px 22px;border-radius:30px;
  opacity:0;transition:.3s;z-index:200;
  box-shadow:0 0 10px rgba(0,210,255,0.4);
}
#toast.show {opacity:1;transform:translateX(-50%) translateY(-6px);}

/* ğŸ§¾ History */
.history-item {
  padding:10px;
  border-bottom:1px solid rgba(255,255,255,0.08);
  font-size:15px;
  color:var(--muted);
}
footer {
  text-align:center;padding:20px;color:var(--muted);
  font-size:14px;
}
.hidden {display:none;}
</style>
</head>
<body>
<header>
  <h2 style="margin:0;font-family:Orbitron">ğŸ” Secret Cipher</h2>
  <nav>
    <button onclick="showSection('cipher')" class="active">Cipher</button>
    <button onclick="showSection('quiz')">Quiz</button>
    <button onclick="showSection('login')">Login</button>
  </nav>
</header>

<!-- Cipher Tool -->
<section id="cipher" class="card">
  <h3>ğŸ“ Cipher Tool</h3>
  <textarea id="input" placeholder="Type your message..."></textarea>
 <div class="controls">
  <button class="btn animate-glow" onclick="encode()">
    ğŸ”’ Encode
  </button>

  <button class="btn animate-glow" onclick="decode()">
    ğŸ”“ Decode
  </button>

  <button class="btn ghost animate-glow" onclick="smartDetect()">
    ğŸ§  Smart Detect
  </button>

  <button class="btn ghost" onclick="copyOutput()">
    ğŸ“‹ Copy Output
  </button>

  <button class="btn danger" onclick="clearAll()">
    ğŸ—‘ï¸ Clear All
  </button>
</div>
  <textarea id="output" readonly placeholder="Result will appear here..."></textarea>
  <h4>ğŸ“œ History</h4>
  <div id="history"></div>
</section>

<!-- Quiz Section -->
<section id="quiz" class="card hidden">
  <h3>ğŸ§© Quiz (Login Required)</h3>
  <div id="quizBox">
    <div id="quizQuestion">Press Start to begin</div>
    <input id="quizAnswer" placeholder="Type your decoded answer" />
    <div class="controls">
      <button class="btn" onclick="submitQuiz()">Submit</button>
      <button class="btn ghost" onclick="nextQuiz()">Next</button>
      <button class="btn danger" onclick="endQuiz()">End</button>
    </div>
    <div style="margin-top:10px">
      <span id="quizProgress">0</span>/<span id="quizTotal">25</span> 
      | Time left: <span id="quizTimer">60</span>s
    </div>
  </div>
  <button class="btn" onclick="startQuiz()" style="margin-top:10px">Start Quiz</button>
</section>

<!-- Login Section -->
<section id="login" class="card hidden">
  <h3>ğŸ”‘ Login / Sign Up</h3>
  <input id="email" type="email" placeholder="Email">
  <input id="password" type="password" placeholder="Password">
  <div class="controls">
    <button class="btn" onclick="signup()">Sign Up</button>
    <button class="btn ghost" onclick="login()">Login</button>
    <button class="btn danger" onclick="logout()">Logout</button>
  </div>
  <input id="resetEmail" type="email" placeholder="Email for reset">
  <button class="btn ghost" onclick="forgotPassword()">Forgot Password</button>
  <p id="userStatus"></p>
</section>

<footer>Â© <span id="year"></span> Secret Cipher</footer>
<div id="toast"></div>

<script type="module">
// Firebase
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, sendPasswordResetEmail, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyBOfDcEpw-p7DNuoUKqlGlTC782yiVdf00",
  authDomain: "cipher-e6c22.firebaseapp.com",
  projectId: "cipher-e6c22",
  storageBucket: "cipher-e6c22.appspot.com",
  messagingSenderId: "345358817477",
  appId: "1:345358817477:web:7ba4dd380d634b559038ac"
};
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

// Helpers
const $ = id => document.getElementById(id);
function toast(msg){
  const t = $("toast");
  t.textContent = msg;
  t.classList.add("show");
  setTimeout(()=>t.classList.remove("show"),2000);
}
function showSection(id){
  ["cipher","quiz","login"].forEach(s => $(s).classList.add("hidden"));
  $(id).classList.remove("hidden");
  document.querySelectorAll("nav button").forEach(b => b.classList.remove("active"));
  document.querySelector(`nav button[onclick="showSection('${id}')"]`).classList.add("active");
}

// Auth
async function signup(){
  try {
    await createUserWithEmailAndPassword(auth,$("email").value,$("password").value);
    toast("Signed up");
  } catch(e){ toast(e.message); }
}
async function login(){
  try {
    await signInWithEmailAndPassword(auth,$("email").value,$("password").value);
    toast("Logged in");
  } catch(e){ toast(e.message); }
}
async function logout(){
  await signOut(auth);
  toast("Logged out");
}
async function forgotPassword(){
  try {
    await sendPasswordResetEmail(auth,$("resetEmail").value);
    toast("Password reset email sent");
  } catch(e){ toast(e.message); }
}
onAuthStateChanged(auth,u=>{
  $("userStatus").textContent = u ? `Logged in as ${u.email}` : "Not logged in";
});

// Cipher
const vmap={a:"1",e:"2",i:"3",o:"4",u:"5"};
const rev={"1":"a","2":"e","3":"i","4":"o","5":"u"};
function encode(){
  const txt=$("input").value;
  let out="";
  for(const c of txt){
    if(vmap[c]) out+=vmap[c];
    else if(/[a-z]/i.test(c)) out+=c+"a";
    else out+=c;
  }
  $("output").value=out;
  addHist("Encoded",out);
}
function decode(){
  const txt=$("input").value;
  let out="";
  for(let i=0;i<txt.length;i++){
    if(rev[txt[i]]) out+=rev[txt[i]];
    else if(/[a-z]/i.test(txt[i]) && txt[i+1]==="a"){ out+=txt[i]; i++; }
    else out+=txt[i];
  }
  $("output").value=out;
  addHist("Decoded",out);
}
function smartDetect(){ /[1-5]/.test($("input").value)?decode():encode(); }
function copyOutput(){ navigator.clipboard.writeText($("output").value); toast("Copied"); }
function clearAll(){ $("input").value=""; $("output").value=""; }
function addHist(type,res){
  const h=$("history");
  h.innerHTML=`<div class='history-item'><b>${type}</b>: ${res}</div>`+h.innerHTML;
}

// Quiz
const QUESTIONS=[ 
  "The quick brown fox jumps over the lazy dog.",
  "Knowledge is power, but wisdom is everything.",
  "Success usually comes to those who are too busy to be looking for it.",
  "Do not watch the clock. Do what it does. Keep going.",
  "Difficult roads often lead to beautiful destinations.",
  "Hard work beats talent when talent doesnâ€™t work hard.",
  "Great things never come from comfort zones.",
  "Dream big and dare to fail.",
  "The only limit to our realization of tomorrow is our doubts of today.",
  "Opportunities don't happen, you create them.",
  "If you want something you've never had, you must be willing to do something you've never done.",
  "Life is 10% what happens to us and 90% how we react to it.",
  "It always seems impossible until it's done.",
  "Don't wait. The time will never be just right.",
  "Act as if what you do makes a difference. It does.",
  "The harder you fall, the higher you bounce.",
  "Small steps every day add up to big results over time.",
  "Creativity is intelligence having fun.",
  "Be kind whenever possible. It is always possible.",
  "Change your thoughts and you change your world.",
  "A smooth sea never made a skilled sailor.",
  "The secret of getting ahead is getting started.",
  "Turn your wounds into wisdom and lessons into strength.",
  "Perseverance is not a long race; it is many short races one after another.",
  "Value the people who value you; pay attention to where you spend your time."
];
let pool=[],qi=0,score=0,timer=null,remain=60;
function enc(s){
  let out="";
  for(const c of s.toLowerCase()){
    if(vmap[c]) out+=vmap[c];
    else if(/[a-z]/.test(c)) out+=c+"a";
    else out+=c;
  }
  return out;
}
function startQuiz(){
  if(!auth.currentUser) return toast("Login required");
  pool=[...QUESTIONS].sort(()=>Math.random()-0.5).slice(0,25);
  qi=0;score=0;showQ();
}
function showQ(){
  if(qi>=pool.length) return endQuiz();
  $("quizQuestion").innerHTML="Decode this:<br>"+enc(pool[qi]);
  $("quizAnswer").value="";
  $("quizProgress").textContent=qi+1;
  $("quizTotal").textContent=pool.length;
  remain=60;
  $("quizTimer").textContent=remain;
  clearInterval(timer);
  timer=setInterval(()=>{
    remain--;
    $("quizTimer").textContent=remain;
    if(remain<=0){
      clearInterval(timer);
      toast("Time up");
      nextQuiz();
    }
  },1000);
}
function submitQuiz(){
  clearInterval(timer);
  if($("quizAnswer").value.trim().toLowerCase()===pool[qi].toLowerCase()){
    score++;toast("Correct");
  }else toast("Wrong: "+pool[qi]);
  qi++;showQ();
}
function nextQuiz(){ clearInterval(timer); qi++; showQ(); }
function endQuiz(){
  clearInterval(timer);
  $("quizQuestion").textContent=`Finished! Score: ${score}/${pool.length}`;
}

$("year").textContent=new Date().getFullYear();

// âœ… FIX: Expose functions globally so buttons work
window.showSection = showSection;
window.signup = signup;
window.login = login;
window.logout = logout;
window.forgotPassword = forgotPassword;
window.encode = encode;
window.decode = decode;
window.smartDetect = smartDetect;
window.copyOutput = copyOutput;
window.clearAll = clearAll;
window.startQuiz = startQuiz;
window.submitQuiz = submitQuiz;
window.nextQuiz = nextQuiz;
window.endQuiz = endQuiz;
</script>
</body>
</html>