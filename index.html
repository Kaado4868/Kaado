<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>üîê Secret Cipher</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- PWA manifest -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0b5ed7">

  <!-- App icons -->
  <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">
  <link rel="apple-touch-icon" href="icon-192.png">

  <style>
    :root {
      --bg: #e0e5ec;
      --text: #222;
      --card: rgba(255, 255, 255, 0.7);
      --shadow: rgba(0,0,0,0.2);
      --primary: linear-gradient(135deg, #6a11cb, #2575fc);
      --danger: linear-gradient(135deg, #ff416c, #ff4b2b);
      --success: linear-gradient(135deg, #11998e, #38ef7d);
    }
    [data-theme="dark"] {
      --bg: #0f111a;
      --text: #f5f5f5;
      --card: rgba(20, 20, 30, 0.8);
      --shadow: rgba(0,0,0,0.6);
    }
    body {
      margin: 0; padding: 0;
      font-family: 'Segoe UI', Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      transition: background 0.4s, color 0.4s;
    }
    header {
      text-align: center;
      padding: 20px;
      background: var(--primary);
      color: white;
      border-radius: 0 0 20px 20px;
      box-shadow: 0 4px 15px var(--shadow);
      position: relative;
    }
    h1 { margin: 0; font-size: 1.8em; }
    p { opacity: 0.9; }
    main {
      display: flex; flex-wrap: wrap; gap: 20px;
      max-width: 1100px; margin: 20px auto; padding: 0 15px;
    }
    section, aside {
      flex: 1; min-width: 280px;
      border-radius: 16px; padding: 20px;
      background: var(--card);
      backdrop-filter: blur(12px);
      box-shadow: 0 8px 24px var(--shadow);
      transition: background 0.4s;
    }
    aside { max-width: 320px; }
    label { font-size: 13px; font-weight: bold; margin: 10px 0; display: block; }
    textarea {
      width: 100%; min-height: 120px;
      margin: 8px 0 15px 0; padding: 12px;
      font-size: 15px; border-radius: 12px;
      border: none; outline: none; resize: vertical;
      background: rgba(255,255,255,0.4);
      backdrop-filter: blur(5px);
      box-shadow: inset 2px 2px 6px rgba(0,0,0,0.1);
      transition: background 0.3s;
    }
    .controls { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 15px; }
    button {
      flex: 1; padding: 12px 15px;
      border: none; border-radius: 10px; cursor: pointer;
      color: white; font-size: 14px; font-weight: 600;
      background: var(--primary);
      box-shadow: 0 4px 12px var(--shadow);
      transition: transform 0.2s, opacity 0.2s;
    }
    button:hover { transform: translateY(-2px); opacity: 0.9; }
    button:active { transform: scale(0.97); }
    button.danger { background: var(--danger); }
    button.success { background: var(--success); }
    .history-item { border-bottom: 1px solid rgba(255,255,255,0.2); padding: 8px 0; font-size: 13px; }
    footer { text-align: center; padding: 15px; margin-top: 30px; font-size: 13px; opacity: 0.8; }
    .toggle-theme {
      position: absolute; top: 15px; right: 20px;
      background: rgba(255,255,255,0.2);
      border: none; border-radius: 50%;
      width: 40px; height: 40px;
      color: white; font-size: 18px;
      cursor: pointer; backdrop-filter: blur(8px);
    }
    #update-toast {
      display:none; position:fixed; bottom:20px; left:50%;
      transform:translateX(-50%);
      background:#333; color:#fff;
      padding:12px 20px; border-radius:10px;
      box-shadow:0 4px 12px rgba(0,0,0,0.3);
      z-index:9999; font-size:14px;
      animation: slideUp 0.4s ease;
    }
    #update-toast button {
      margin-left:10px; background:#4CAF50; border:none;
      padding:5px 10px; border-radius:6px; color:white; cursor:pointer;
    }
    @keyframes slideUp {
      from { transform:translate(-50%, 50px); opacity:0; }
      to { transform:translate(-50%, 0); opacity:1; }
    }
  </style>
</head>
<body>
  <header>
    <h1>üîê Secret Cipher</h1>
    <p>Type ‚Üí Encode ‚Üí Decode ‚Üí Share</p>
    <button class="toggle-theme" onclick="toggleTheme()">üåô</button>
  </header>
  <main>
    <section>
      <label for="input">Input</label>
      <textarea id="input" placeholder="Type your message here..."></textarea>
      <div class="controls">
        <button onclick="encode()">üîí Encode</button>
        <button onclick="decode()">üîì Decode</button>
        <button onclick="smartDetect()">ü§ñ Smart Detect</button>
        <button class="danger" onclick="clearAll()">üóë Clear</button>
        <button class="success" onclick="copyResult()">üìã Copy</button>
        <button onclick="shareResult()">üì§ Share</button>
      </div>
      <label for="output">Output</label>
      <textarea id="output" placeholder="Result will appear here..." readonly></textarea>
    </section>
    <aside>
      <h3>üìú Recent History</h3>
      <div id="history"></div>
      <div style="margin-top:10px; display:flex; gap:10px;">
        <button onclick="copyHistory()">Copy All</button>
        <button class="danger" onclick="clearHistory()">Clear</button>
      </div>
      <h3 style="margin-top:20px;">üìû Contact</h3>
      <p><strong>Email:</strong> <a href="mailto:abdulkadirbukar2006@gmail.com">abdulkadirbukar2006@gmail.com</a></p>
      <p><strong>Phone:</strong> <a href="tel:+2347048684062">07048684062</a></p>
      <p><a href="https://wa.me/2347048684062" target="_blank">Message on WhatsApp</a></p>
    </aside>
  </main>
  <footer>Made with ‚ù§Ô∏è Secret Cipher ‚Ä¢ <span id="year"></span></footer>
  <div id="update-toast">üîÑ A new version is available! <button onclick="refreshApp()">Refresh</button></div>
  <script>
    const inputEl=document.getElementById("input");
    const outputEl=document.getElementById("output");
    const historyEl=document.getElementById("history");
    let history=JSON.parse(localStorage.getItem("cipherHistory")||"[]");

    function renderHistory(){
      historyEl.innerHTML=history.length===0?"<p style='opacity:0.7'>No history yet.</p>":
        history.map((h,i)=>`
          <div class="history-item">
            <strong>${h.type}:</strong> ${h.result}
            <br>
            <button onclick="useHistory(${i})">Use</button>
            <button onclick="copyHistoryItem(${i})">Copy</button>
          </div>`).join("");
    }
    function saveHistory(item){history.unshift(item);history=history.slice(0,20);localStorage.setItem("cipherHistory",JSON.stringify(history));renderHistory();}
    function encode(){let text=inputEl.value.toLowerCase();let result="";let vowels={a:"1",e:"2",i:"3",o:"4",u:"5"};for(let ch of text){if(vowels[ch])result+=vowels[ch];else if(/[a-z]/.test(ch))result+=ch+"a";else result+=ch;}outputEl.value=result;saveHistory({type:"Encoded",input:text,result});}
    function decode(){let text=inputEl.value;let result="";let vowels={"1":"a","2":"e","3":"i","4":"o","5":"u"};for(let i=0;i<text.length;i++){let ch=text[i];if(vowels[ch])result+=vowels[ch];else if(/[a-z]/i.test(ch)){result+=ch;if(text[i+1]==="a")i++;}else result+=ch;}outputEl.value=result;saveHistory({type:"Decoded",input:text,result});}
    function smartDetect(){const text=inputEl.value.trim();if(!text)return;const digitCount=(text.match(/[12345]/g)||[]).length;const vowelCount=(text.match(/[aeiou]/gi)||[]).length;if(digitCount>vowelCount)decode();else encode();}
    function clearAll(){inputEl.value="";outputEl.value="";}
    function copyResult(){if(!outputEl.value)return alert("Nothing to copy");navigator.clipboard.writeText(outputEl.value);alert("Copied to clipboard ‚úÖ");}
    function shareResult(){if(!outputEl.value)return alert("Nothing to share");if(navigator.share){navigator.share({title:"Secret Cipher",text:outputEl.value});}else{window.open(`https://wa.me/?text=${encodeURIComponent(outputEl.value)}`,"_blank");}}
    function copyHistory(){if(!history.length)return alert("No history");const all=history.map(h=>`${h.type}: ${h.result}`).join("\n");navigator.clipboard.writeText(all);alert("History copied ‚úÖ");}
    function copyHistoryItem(i){navigator.clipboard.writeText(history[i].result).then(()=>alert("Copied ‚úÖ"));}
    function clearHistory(){if(!confirm("Clear history?"))return;history=[];localStorage.removeItem("cipherHistory");renderHistory();}
    function useHistory(i){inputEl.value=history[i].result;smartDetect();}
    document.getElementById("year").textContent=new Date().getFullYear();renderHistory();
    function toggleTheme(){let current=document.body.getAttribute("data-theme");if(current==="dark"){document.body.removeAttribute("data-theme");localStorage.setItem("theme","light");document.querySelector(".toggle-theme").textContent="üåô";}else{document.body.setAttribute("data-theme","dark");localStorage.setItem("theme","dark");document.querySelector(".toggle-theme").textContent="‚òÄÔ∏è";}}
    if(localStorage.getItem("theme")==="dark"){document.body.setAttribute("data-theme","dark");document.querySelector(".toggle-theme").textContent="‚òÄÔ∏è";}
    function refreshApp(){window.location.reload();}
    if('serviceWorker' in navigator){navigator.serviceWorker.register('/service-worker.js').then(reg=>{reg.addEventListener('updatefound',()=>{const newWorker=reg.installing;newWorker.addEventListener('statechange',()=>{if(newWorker.state==='installed'&&navigator.serviceWorker.controller){document.getElementById("update-toast").style.display="block";}});});});}
  </script>
</body>
</html>