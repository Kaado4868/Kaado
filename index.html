<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>üîê Secret Cipher</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- PWA manifest -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0b5ed7">
  <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">
  <link rel="apple-touch-icon" href="icon-192.png">

  <style>
    body { font-family: 'Segoe UI', Arial, sans-serif; margin:0; padding:0; background:#f7f9fc; color:#333; }
    header { text-align:center; padding:20px; background:#2575fc; color:#fff; border-radius:0 0 20px 20px; }
    h1 { margin:0; }
    main { max-width:1100px; margin:20px auto; padding:0 15px; display:flex; flex-wrap:wrap; gap:20px; }
    section, aside { background:white; border-radius:16px; padding:20px; box-shadow:0 4px 12px rgba(0,0,0,0.1); flex:1; min-width:280px; }
    aside { max-width:320px; }
    textarea { width:100%; min-height:100px; margin:8px 0 15px; padding:10px; border-radius:8px; border:1px solid #ddd; }
    .controls { display:flex; flex-wrap:wrap; gap:10px; margin-bottom:15px; }
    button { flex:1; padding:10px; border:none; border-radius:8px; cursor:pointer; background:#2575fc; color:white; font-weight:bold; }
    button:hover { opacity:0.9; }
    button.danger { background:#e55353; }
    button.success { background:#198754; }
    .history-item { border-bottom:1px solid #eee; padding:6px 0; font-size:13px; }
    footer { text-align:center; margin-top:30px; padding:10px; font-size:13px; background:#f0f0f0; }

    /* Quiz Styles */
    #quiz { margin:20px; background:white; border-radius:16px; padding:20px; box-shadow:0 4px 12px rgba(0,0,0,0.1); }
    #quiz .question { font-size:15px; margin:10px 0; padding:10px; background:#f1f1f1; border-radius:8px; }
    #quiz input { width:100%; padding:10px; border-radius:8px; border:1px solid #ccc; margin:10px 0; }
    #quiz-timer { font-weight:bold; color:#e55353; }
  </style>
</head>
<body>
  <header>
    <h1>üîê Secret Cipher</h1>
    <p>Type ‚Üí Encode ‚Üí Decode ‚Üí Share ‚Üí Quiz</p>
  </header>

  <main>
    <!-- Cipher Tool -->
    <section>
      <h3>üìù Cipher Tool</h3>
      <label for="input">Input</label>
      <textarea id="input" placeholder="Type your message here..."></textarea>
      <div class="controls">
        <button onclick="encode()">Encode</button>
        <button onclick="decode()">Decode</button>
        <button onclick="smartDetect()">Smart Detect</button>
        <button class="danger" onclick="clearAll()">Clear</button>
        <button class="success" onclick="copyResult()">Copy</button>
        <button onclick="shareResult()">Share</button>
      </div>
      <label for="output">Output</label>
      <textarea id="output" readonly placeholder="Result will appear here..."></textarea>
    </section>

    <!-- History & Contact -->
    <aside>
      <h3>üìú History</h3>
      <div id="history"></div>
      <div style="margin-top:10px; display:flex; gap:10px;">
        <button onclick="copyHistory()">Copy All</button>
        <button class="danger" onclick="clearHistory()">Clear</button>
      </div>
      <h3 style="margin-top:20px;">üìû Contact</h3>
      <p><b>Email:</b> <a href="mailto:abdulkadirbukar2006@gmail.com">abdulkadirbukar2006@gmail.com</a></p>
      <p><b>Phone:</b> <a href="tel:+2347048684062">07048684062</a></p>
      <p><a href="https://wa.me/2347048684062" target="_blank">Message on WhatsApp</a></p>
    </aside>
  </main>

  <!-- Daily Quiz Section -->
  <section id="quiz">
    <h3>üß© Daily Cipher Quiz</h3>
    <p>Decode 5 sentences in 15 seconds each. Available once every 24 hours.</p>
    <div id="quiz-container">
      <button onclick="startQuiz()">Start Quiz</button>
    </div>
  </section>

  <footer>
    Made with ‚ù§Ô∏è Secret Cipher ‚Ä¢ <span id="year"></span>
  </footer>

  <script>
    const inputEl=document.getElementById("input");
    const outputEl=document.getElementById("output");
    const historyEl=document.getElementById("history");
    let history=JSON.parse(localStorage.getItem("cipherHistory")||"[]");

    function renderHistory(){historyEl.innerHTML=history.length===0?"<p style='opacity:0.7'>No history yet.</p>":history.map((h,i)=>`<div class="history-item"><b>${h.type}:</b> ${h.result}<br><button onclick="useHistory(${i})">Use</button><button onclick="navigator.clipboard.writeText(history[${i}].result)">Copy</button></div>`).join("");}
    function saveHistory(item){history.unshift(item);history=history.slice(0,20);localStorage.setItem("cipherHistory",JSON.stringify(history));renderHistory();}
    function encode(){let text=inputEl.value.toLowerCase();let result="";let vowels={a:"1",e:"2",i:"3",o:"4",u:"5"};for(let ch of text){if(vowels[ch])result+=vowels[ch];else if(/[a-z]/.test(ch))result+=ch+"a";else result+=ch;}outputEl.value=result;saveHistory({type:"Encoded",input:text,result});}
    function decode(){let text=inputEl.value;let result="";let vowels={"1":"a","2":"e","3":"i","4":"o","5":"u"};for(let i=0;i<text.length;i++){let ch=text[i];if(vowels[ch])result+=vowels[ch];else if(/[a-z]/i.test(ch)){result+=ch;if(text[i+1]==="a")i++;}else result+=ch;}outputEl.value=result;saveHistory({type:"Decoded",input:text,result});}
    function smartDetect(){const text=inputEl.value.trim();if(!text)return;const digitCount=(text.match(/[12345]/g)||[]).length;const vowelCount=(text.match(/[aeiou]/gi)||[]).length;if(digitCount>vowelCount)decode();else encode();}
    function clearAll(){inputEl.value="";outputEl.value="";}
    function copyResult(){if(!outputEl.value)return alert("Nothing to copy");navigator.clipboard.writeText(outputEl.value);alert("Copied ‚úÖ");}
    function shareResult(){if(!outputEl.value)return alert("Nothing to share");if(navigator.share){navigator.share({title:"Secret Cipher",text:outputEl.value});}else{window.open(`https://wa.me/?text=${encodeURIComponent(outputEl.value)}`,"_blank");}}
    function copyHistory(){if(!history.length)return alert("No history");navigator.clipboard.writeText(history.map(h=>`${h.type}: ${h.result}`).join("\\n"));alert("History copied ‚úÖ");}
    function clearHistory(){if(!confirm("Clear history?"))return;history=[];localStorage.removeItem("cipherHistory");renderHistory();}
    function useHistory(i){inputEl.value=history[i].result;smartDetect();}
    document.getElementById("year").textContent=new Date().getFullYear();
    renderHistory();

    // ============ QUIZ FEATURE ============
    const quizSentences=[
      "The quick brown fox jumps over the lazy dog.",
      "Knowledge is power, but wisdom is everything.",
      "Success usually comes to those who are too busy to be looking for it.",
      "Do not watch the clock. Do what it does. Keep going.",
      "Difficult roads often lead to beautiful destinations.",
      "Hard work beats talent when talent doesn‚Äôt work hard.",
      "Great things never come from comfort zones.",
      "Dream big and dare to fail.",
      "The only limit to our realization of tomorrow is our doubts of today.",
      "Opportunities don't happen, you create them."
    ];
    let quizIndex=0,quizScore=0,quizTimer;

    function cipherEncode(text){
      let vowels={a:"1",e:"2",i:"3",o:"4",u:"5"};let res="";
      for(let ch of text.toLowerCase()){if(vowels[ch])res+=vowels[ch];else if(/[a-z]/.test(ch))res+=ch+"a";else res+=ch;}
      return res;
    }

    function startQuiz(){
      let lastPlayed=localStorage.getItem("quizLastPlayed");
      if(lastPlayed && Date.now()-parseInt(lastPlayed)<24*60*60*1000){
        document.getElementById("quiz-container").innerHTML="<p>‚õî You already played today. Come back tomorrow!</p>";return;
      }
      quizIndex=0;quizScore=0;
      nextQuestion();
    }

    function nextQuestion(){
      if(quizIndex>=5){endQuiz();return;}
      let sentence=quizSentences[Math.floor(Math.random()*quizSentences.length)];
      let encoded=cipherEncode(sentence);
      document.getElementById("quiz-container").innerHTML=`
        <div class="question">Question ${quizIndex+1}/5<br><b>Decode this:</b><br>${encoded}</div>
        <div>Time left: <span id="quiz-timer">15</span> sec</div>
        <input type="text" id="quiz-answer" placeholder="Type decoded sentence">
        <button onclick="submitAnswer('${sentence}')">Submit</button>`;
      startTimer(15,()=>submitAnswer(sentence));
    }

    function startTimer(seconds,callback){
      clearInterval(quizTimer);
      let remaining=seconds;
      document.getElementById("quiz-timer").textContent=remaining;
      quizTimer=setInterval(()=>{
        remaining--;
        document.getElementById("quiz-timer").textContent=remaining;
        if(remaining<=0){clearInterval(quizTimer);callback();}
      },1000);
    }

    function submitAnswer(correct){
      clearInterval(quizTimer);
      let ans=document.getElementById("quiz-answer").value.trim();
      if(ans.toLowerCase()===correct.toLowerCase()){quizScore++;alert("‚úÖ Correct!");}
      else{alert("‚ùå Wrong! Correct was: "+correct);}
      quizIndex++;nextQuestion();
    }

    function endQuiz(){
      const today=new Date().toISOString().split("T")[0]; // YYYY-MM-DD
      let quizHistory=JSON.parse(localStorage.getItem("quizHistory")||"[]");

      // Save today's result
      quizHistory.unshift({date:today,score:quizScore});
      quizHistory=quizHistory.slice(0,7); // last 7 days only

      localStorage.setItem("quizHistory",JSON.stringify(quizHistory));
      localStorage.setItem("quizLastPlayed",Date.now().toString());

      // Find best score
      let best=Math.max(...quizHistory.map(h=>h.score));
      let leaderboard=quizHistory.map(h=>`üìÖ ${h.date} ‚Üí ${h.score}/5`).join("<br>");

      document.getElementById("quiz-container").innerHTML=`
        <p>üéâ Quiz Finished!</p>
        <p>Your Score: <b>${quizScore}/5</b></p>
        <p>üî• Best Score: <b>${best}/5</b></p>
        <h4>üìú Past 7 Days:</h4>
        <div>${leaderboard}</div>`;
    }
  </script>
</body>
</html>