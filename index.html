<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>🔐 Secret Cipher</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#4b0082">
<link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
<link rel="apple-touch-icon" href="icon-192.png">
<style>
:root{--bg1:#6a11cb;--bg2:#2575fc;--card:#ffffff;--accent:#ff6a88;}
body{margin:0;font-family:Inter,Segoe UI,Roboto,Arial;background:linear-gradient(135deg,var(--bg1),var(--bg2));color:#111;min-height:100vh;display:flex;flex-direction:column;}
.app{max-width:1100px;margin:30px auto;padding:20px;display:grid;grid-template-columns:2fr 1fr;gap:20px;}
.card{background:rgba(255,255,255,0.95);border-radius:14px;padding:18px;box-shadow:0 10px 30px rgba(0,0,0,0.15);}
h1{margin:0 0 8px 0;color:white;text-align:center;}
.header{background:transparent;padding:18px;text-align:center;}
textarea{width:100%;min-height:140px;padding:12px;border-radius:10px;border:1px solid #eee;resize:vertical;font-size:15px;}
.controls{display:flex;gap:10px;flex-wrap:wrap;margin:12px 0;}
.btn{flex:1;padding:12px;border-radius:10px;border:none;color:white;font-weight:700;cursor:pointer;background:linear-gradient(90deg,#ff6a88,#5b18b0);box-shadow:0 6px 18px rgba(0,0,0,0.12);transition:transform .15s;}
.btn:hover{transform:translateY(-3px);}
.btn.danger{background:linear-gradient(90deg,#ff416c,#ff4b2b);}
.btn.success{background:linear-gradient(90deg,#11998e,#38ef7d);}
.sidebar .history-item{padding:8px 0;border-bottom:1px solid #f1f1f1;font-size:14px;}
footer{margin-top:20px;text-align:center;padding:18px;color:white;}
.play-quiz{background:linear-gradient(90deg,#ffd700,#ff6a88);color:#111;padding:10px 16px;border-radius:12px;border:none;font-weight:800;cursor:pointer;}
.small{font-size:13px;color:#555;}
</style>
</head>
<body>
<header class="header"><h1>🔐 Secret Cipher</h1></header>
<div class="app">
  <div class="card" id="main-card">
    <h2>📝 Cipher Tool</h2>
    <label for="input">Input</label>
    <textarea id="input" placeholder="Type your message..."></textarea>
    <div class="controls">
      <button class="btn" id="encodeBtn">🔒 Encode</button>
      <button class="btn" id="decodeBtn">🔓 Decode</button>
      <button class="btn" id="smartBtn">🤖 Smart Detect</button>
      <button class="btn danger" id="clearBtn">🗑 Clear</button>
      <button class="btn success" id="copyBtn">📋 Copy</button>
      <button class="btn" id="shareBtn">📤 Share</button>
    </div>
    <label for="output">Output</label>
    <textarea id="output" readonly placeholder="Result will appear here..."></textarea>
  </div>

  <aside class="card sidebar">
    <h3>📜 Recent History</h3>
    <div id="history"></div>
    <div style="display:flex;gap:8px;margin-top:12px;">
      <button class="btn" id="copyAll">Copy All</button>
      <button class="btn danger" id="clearHistoryBtn">Clear</button>
    </div>
    <h3 style="margin-top:18px;">📞 Contact</h3>
    <p class="small">Email: <a href="mailto:abdulkadirbukar2006@gmail.com">abdulkadirbukar2006@gmail.com</a></p>
    <p class="small">Phone: <a href="tel:+2347048684062">07048684062</a></p>
  </aside>
</div>

<footer>
  <button class="play-quiz" onclick="location.href='quiz.html'">Play Daily Quiz</button>
</footer>

<script src="anime.min.js"></script>
<script>
// app logic
const inputEl=document.getElementById('input');
const outputEl=document.getElementById('output');
const historyEl=document.getElementById('history');
let historyArr=JSON.parse(localStorage.getItem('cipherHistory')||'[]');

function renderHistory(){
  historyEl.innerHTML = historyArr.length? historyArr.map((h,i)=>`<div class="history-item"><strong>${h.type}:</strong> ${h.result}<br><button onclick="useHistory(${i})">Use</button> <button onclick="copyHistoryItem(${i})">Copy</button></div>`).join('') : '<p class="small">No history yet.</p>';
}
function saveHistory(it){historyArr.unshift(it);historyArr=historyArr.slice(0,20);localStorage.setItem('cipherHistory',JSON.stringify(historyArr));renderHistory();}

function cipherEncode(text){let vowels={a:'1',e:'2',i:'3',o:'4',u:'5'};let res='';for(let ch of text.toLowerCase()){if(vowels[ch])res+=vowels[ch];else if(/[a-z]/.test(ch))res+=ch+'a';else res+=ch;}return res;}
function cipherDecode(text){let vowels={'1':'a','2':'e','3':'i','4':'o','5':'u'};let res='';for(let i=0;i<text.length;i++){let ch=text[i];if(vowels[ch])res+=vowels[ch];else if(/[a-z]/i.test(ch)){res+=ch;if(text[i+1]==='a')i++;}else res+=ch;}return res;}

document.getElementById('encodeBtn').addEventListener('click', ()=>{
  const r = cipherEncode(inputEl.value);
  outputEl.value = r;
  saveHistory({type:'Encoded', input: inputEl.value, result: r});
});
document.getElementById('decodeBtn').addEventListener('click', ()=>{
  const r = cipherDecode(inputEl.value);
  outputEl.value = r;
  saveHistory({type:'Decoded', input: inputEl.value, result: r});
});
function smartDetect(){
  const text = inputEl.value.trim();
  if(!text) return;
  const digitCount = (text.match(/[12345]/g)||[]).length;
  const suffixCount = (text.match(/[a-z]a/g)||[]).length;
  const vowelCount = (text.match(/[aeiou]/gi)||[]).length;
  // smarter decision
  if(digitCount > suffixCount + vowelCount) {
    const r = cipherDecode(text);
    outputEl.value = r;
    saveHistory({type:'Decoded', input: text, result: r});
    return;
  }
  if(suffixCount > digitCount) {
    const r = cipherDecode(text);
    outputEl.value = r;
    saveHistory({type:'Decoded', input: text, result: r});
    return;
  }
  const tryEnc = cipherEncode(text);
  if(tryEnc !== text) {
    outputEl.value = tryEnc;
    saveHistory({type:'Encoded', input: text, result: tryEnc});
  } else {
    const tryDec = cipherDecode(text);
    outputEl.value = tryDec;
    saveHistory({type:'Decoded', input: text, result: tryDec});
  }
}
document.getElementById('smartBtn').addEventListener('click', smartDetect);

document.getElementById('clearBtn').addEventListener('click', ()=>{
  inputEl.value=''; outputEl.value='';
});
document.getElementById('copyBtn').addEventListener('click', ()=>{
  if(!outputEl.value) return alert('Nothing to copy');
  navigator.clipboard.writeText(outputEl.value).then(()=>alert('Copied ✅'));
});
document.getElementById('shareBtn').addEventListener('click', ()=>{
  if(!outputEl.value) return alert('Nothing to share');
  if(navigator.share){navigator.share({title:'Secret Cipher', text:outputEl.value});}
  else window.open('https://wa.me/?text='+encodeURIComponent(outputEl.value),'_blank');
});
function copyAll(){ if(!historyArr.length) return alert('No history'); navigator.clipboard.writeText(historyArr.map(h=>`${h.type}: ${h.result}`).join('\\n')); alert('History copied ✅');}
document.getElementById('copyAll').addEventListener('click', copyAll);
document.getElementById('clearHistoryBtn').addEventListener('click', ()=>{
  if(!confirm('Clear history?')) return; historyArr=[]; localStorage.removeItem('cipherHistory'); renderHistory();
});
function useHistory(i){ inputEl.value = historyArr[i].result; smartDetect(); }
function copyHistoryItem(i){ navigator.clipboard.writeText(historyArr[i].result).then(()=>alert('Copied ✅')); }

document.addEventListener('DOMContentLoaded', ()=>{ renderHistory(); });

// register service worker
if('serviceWorker' in navigator){ navigator.serviceWorker.register('/service-worker.js').catch(()=>{}); }
</script>
</body>
</html>