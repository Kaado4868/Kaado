<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>üîê Secret Cipher ‚Äî Vowel Numbers</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body {
      margin:0;font-family: Inter,Segoe UI,Arial,sans-serif;color:#fff;
      background:linear-gradient(135deg,#0d1117,#121826);
      display:flex;flex-direction:column;min-height:100vh;
    }
    header {text-align:center;padding:20px;background:#1f2937;}
    main {flex:1;display:flex;flex-wrap:wrap;gap:20px;padding:20px;}
    section,aside {
      flex:1;min-width:300px;padding:18px;border-radius:12px;
      background:rgba(255,255,255,0.05);backdrop-filter:blur(8px);
      box-shadow:0 4px 12px rgba(0,0,0,0.4);
    }
    textarea,input {
      width:100%;padding:10px;border-radius:8px;border:0;
      margin:6px 0;background:rgba(255,255,255,0.1);color:#fff;
    }
    button {
      border:0;padding:10px 14px;margin:5px;border-radius:8px;
      font-weight:bold;cursor:pointer;transition:0.2s;
    }
    button:hover {opacity:0.9}
    .btn.login{background:#6366f1;color:#fff;}
    .btn.signup{background:#10b981;color:#fff;}
    .btn.logout{background:#ef4444;color:#fff;}
    .google-btn {
      display:flex;align-items:center;justify-content:center;gap:8px;
      background:#fff;color:#444;width:100%;padding:10px;
      border-radius:6px;font-weight:500;cursor:pointer;
    }
    .google-btn img{width:20px;height:20px}
    .history-item {padding:6px;background:rgba(0,0,0,0.25);border-radius:6px;margin-bottom:6px;font-size:14px;}
    footer{text-align:center;padding:10px;background:#111827;font-size:13px;}

    /* Login popup */
    #loginScreen {
      position:fixed;inset:0;background:rgba(0,0,0,0.9);
      display:flex;align-items:center;justify-content:center;z-index:99;
    }
    #loginBox {
      background:#1e293b;padding:20px;border-radius:10px;width:300px;text-align:center;
    }
    .btn-row {display:flex;gap:10px;justify-content:center}
    #toast {position:fixed;bottom:20px;left:50%;transform:translateX(-50%);
      background:#000;padding:10px 16px;border-radius:20px;opacity:0;transition:.3s;}
    #toast.show{opacity:1}
  </style>
</head>
<body>
  <!-- Login -->
  <div id="loginScreen">
    <div id="loginBox">
      <h2>üîë Login / Sign Up</h2>
      <input id="username" placeholder="Email">
      <input id="password" type="password" placeholder="Password">
      <div class="btn-row">
        <button onclick="login()" class="btn login">Login</button>
        <button onclick="signup()" class="btn signup">Sign Up</button>
      </div>
      <p>or</p>
      <button onclick="loginWithGoogle()" class="google-btn">
        <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg">
        <span>Sign in with Google</span>
      </button>
      <p><a href="#" onclick="forgotPassword()">Forgot password?</a></p>
    </div>
  </div>

  <header>
    <h1>üîê Secret Cipher ‚Äî Vowel Numbers</h1>
    <p id="welcomeUser"></p>
    <button onclick="logout()" class="btn logout">Logout</button>
  </header>

  <main>
    <section>
      <h3>üìù Cipher Tool</h3>
      <textarea id="input" placeholder="Type message..."></textarea>
      <textarea id="output" readonly placeholder="Result..."></textarea>
      <div>
        <button onclick="encode()" class="btn login">Encode</button>
        <button onclick="decode()" class="btn signup">Decode</button>
        <button onclick="smartDetect()" class="btn">Smart Detect</button>
        <button onclick="copyResult()" class="btn">Copy</button>
        <button onclick="clearAll()" class="btn logout">Clear</button>
      </div>
      <h3>üß© Quiz</h3>
      <div id="quiz-status">Not started</div>
      <div id="quiz-container"></div>
      <button onclick="startQuiz()" class="btn signup">Start Quiz</button>
    </section>
    <aside>
      <h3>üìú History</h3>
      <div id="history"></div>
      <button onclick="clearHistory()" class="btn logout">Clear</button>
    </aside>
  </main>

  <footer>¬© <span id="year"></span> Secret Cipher</footer>
  <div id="toast"></div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, 
           signOut, sendPasswordResetEmail, GoogleAuthProvider, signInWithPopup, onAuthStateChanged } 
  from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

  // Firebase config (replace with your real values)
  const firebaseConfig = {
    apiKey: "AIzaSyBOfDcEpw-p7DNuoUKqlGlTC782yiVdf00",
    authDomain: "cipher-e6c22.firebaseapp.com",
    projectId: "cipher-e6c22",
    storageBucket: "cipher-e6c22.appspot.com",
    messagingSenderId: "345358817477",
    appId: "1:345358817477:web:7ba4dd380d634b559038ac"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const provider = new GoogleAuthProvider();

  // Toast
  function toast(msg){
    const t=document.getElementById("toast");
    t.textContent=msg;t.classList.add("show");
    setTimeout(()=>t.classList.remove("show"),2000);
  }

  // Auth
  window.login = function(){
    const email=document.getElementById("username").value;
    const pass=document.getElementById("password").value;
    signInWithEmailAndPassword(auth,email,pass)
      .catch(e=>toast(e.message));
  };
  window.signup = function(){
    const email=document.getElementById("username").value;
    const pass=document.getElementById("password").value;
    createUserWithEmailAndPassword(auth,email,pass)
      .then(()=>toast("Account created"))
      .catch(e=>toast(e.message));
  };
  window.logout = function(){
    signOut(auth);
  };
  window.forgotPassword = function(){
    const email=document.getElementById("username").value;
    if(!email)return toast("Enter email first");
    sendPasswordResetEmail(auth,email).then(()=>toast("üì© Reset email sent"));
  };
  window.loginWithGoogle = function(){
    signInWithPopup(auth,provider).catch(e=>toast(e.message));
  };

  onAuthStateChanged(auth,user=>{
    if(user){
      document.getElementById("loginScreen").style.display="none";
      document.getElementById("welcomeUser").textContent="Welcome "+(user.displayName||user.email);
    }else{
      document.getElementById("loginScreen").style.display="flex";
      document.getElementById("welcomeUser").textContent="";
    }
  });

  // Cipher
  const vmap={a:"1",e:"2",i:"3",o:"4",u:"5"};
  const vrev={"1":"a","2":"e","3":"i","4":"o","5":"u"};
  function encode(){let txt=document.getElementById("input").value,out="";for(const c of txt){if(vmap[c])out+=vmap[c];else if(vmap[c.toLowerCase()])out+=vmap[c.toLowerCase()];else if(/[A-Za-z]/.test(c))out+=c+"a";else out+=c;}document.getElementById("output").value=out;addHist("Encoded",txt,out);}
  function decode(){let txt=document.getElementById("input").value,out="";for(let i=0;i<txt.length;i++){const c=txt[i];if(vrev[c])out+=vrev[c];else if(/[A-Za-z]/.test(c)&&txt[i+1]==="a"){out+=c;i++;}else out+=c;}document.getElementById("output").value=out;addHist("Decoded",txt,out);}
  function smartDetect(){const txt=document.getElementById("input").value;if(/[1-5]/.test(txt))decode();else encode();}
  function copyResult(){navigator.clipboard.writeText(document.getElementById("output").value);toast("Copied")}
  function clearAll(){document.getElementById("input").value="";document.getElementById("output").value="";}

  // History
  function addHist(type,inp,res){let h=JSON.parse(localStorage.getItem("history")||"[]");h.unshift({type,res,date:new Date().toLocaleString()});localStorage.setItem("history",JSON.stringify(h));renderHistory();}
  function renderHistory(){let h=JSON.parse(localStorage.getItem("history")||"[]");document.getElementById("history").innerHTML=h.map(x=>`<div class='history-item'><b>${x.type}</b>: ${x.res}<br><small>${x.date}</small></div>`).join("")||"No history";}
  function clearHistory(){localStorage.removeItem("history");renderHistory();}
  renderHistory();

  // Quiz
  const qs=["The quick brown fox jumps over the lazy dog.","Knowledge is power, but wisdom is everything.","Dream big and dare to fail."];
  let qi=0,score=0,timer;
  window.startQuiz=function(){qi=0;score=0;nextQ();}
  function nextQ(){if(qi>=qs.length)return endQ();let s=qs[qi];let enc=encSen(s);document.getElementById("quiz-container").innerHTML=`<div><b>Q${qi+1}</b>: ${enc}</div><input id='ans'><button onclick="subAns('${s.replace(/'/g,"\\'")}')">Submit</button><div>‚è± <span id='tim'>30</span></div>`;startT();}
  function encSen(txt){let out="";for(const c of txt){if(vmap[c])out+=vmap[c];else if(vmap[c.toLowerCase()])out+=vmap[c.toLowerCase()];else if(/[A-Za-z]/.test(c))out+=c+"a";else out+=c;}return out;}
  function startT(){let t=30;clearInterval(timer);timer=setInterval(()=>{t--;document.getElementById("tim").textContent=t;if(t<=0){clearInterval(timer);subAns(null,true)}},1000);}
  window.subAns=function(correct,timeout=false){clearInterval(timer);let a=document.getElementById("ans").value;if(!timeout&&a.toLowerCase()===correct.toLowerCase()){score++;toast("‚úÖ Correct")}else toast("‚ùå Wrong");qi++;setTimeout(nextQ,800);}
  function endQ(){document.getElementById("quiz-container").innerHTML=`Done! Score: ${score}/${qs.length}`;}

  document.getElementById("year").textContent=new Date().getFullYear();
</script>
</body>
</html>